"use strict";var e=require("prop-types"),t=require("react"),n=require("react-ace");function a(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}require("ace-builds/src-noconflict/theme-monokai");var i=a(t),r=a(n);!function(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!=typeof document){var a=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===n&&a.firstChild?a.insertBefore(i,a.firstChild):a.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}}("@import url(https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css);:root{--timeline-bar-height:20px;--timeline-cursor-height:30px}input::-webkit-inner-spin-button,input::-webkit-outer-spin-button{-webkit-appearance:none;display:none;margin:0;opacity:.5}input[type=number]{-moz-appearance:textfield}.timeline-wrapper{margin:0 auto;position:relative;width:1100px}.timeline-bar,.timeline-player{background-color:#a9a9a9;height:20px;position:relative}.timeline-player{align-items:center;display:flex;justify-content:center;width:calc(100% + 3px)}.timeline-player *{padding:0 2rem}.current-snap{font-weight:700}.current-snap input{height:100%;padding:0;width:10px}.fa{color:#444;cursor:pointer}.timeline-cursor{border-radius:50%;height:30px;left:0;top:calc(var(--timeline-bar-height)/2 - var(--timeline-cursor-height)/2);width:30px}.timeline-cursor,.timeline-item{cursor:pointer;position:absolute}.timeline-item{height:100%;width:3px}.red{background-color:red}.white{background-color:#676767}.blue{background-color:#1b36ba}.timeslot{background-color:#fff;display:none;padding:.3rem 0;position:absolute;right:-13.5px;top:-20px;width:30px;z-index:5}.timeslot p{font-size:10px;margin:0;text-align:center}.timeline-item:hover .timeslot{display:block}.copy-paste-marker{background-color:#bd2e4c5e;position:absolute}.pointer{clip-path:polygon(0 0,100% 0,50% 100%);height:10px;left:calc(50% - 5px);position:absolute;top:-25%;width:10px;z-index:5}");const l=e.exact({startRow:e.number.isRequired,endRow:e.number.isRequired,startCol:e.number.isRequired,endCol:e.number.isRequired,className:e.string.isRequired,type:e.oneOf(["text","fullLine","screenLine"])}),o=e.exact({actionType:e.oneOf(["PASTE","TEST","TYPE"]).isRequired,code:e.string.isRequired,time:e.number.isRequired,lang:e.string,markers:e.arrayOf(l)}),c=({timelineArray:e,duration:t,setFocusedActionIndex:n,focusedActionIndex:a})=>{const r=e=>{switch(e){case"PASTE":return"red";case"TYPE":default:return"white";case"TEST":return"blue"}};return i.default.createElement("div",{className:"timeline-bar"},e&&e.map(((e,l)=>i.default.createElement("div",{className:`timeline-item ${r(e.actionType)}`,key:`${e.lang}-${l}`,style:{left:e.time/t*100+"%"},onClick:()=>n(l)},i.default.createElement("div",{className:"timeslot"},i.default.createElement("p",null,(e=>{const t=e%3600;return Math.floor(e/3600)+":"+Math.floor(t/60)+":"+t%60})(e.time))),a===l&&i.default.createElement("div",{className:`pointer ${r(e.actionType)}`})))))};c.propTypes={timelineArray:e.arrayOf(o).isRequired,duration:e.number.isRequired,setFocusedActionIndex:e.func.isRequired,focusedActionIndex:e.number.isRequired},window.ace.config.set("basePath","https://cdn.jsdelivr.net/npm/ace-builds@1.4.13/src-noconflict/");const s=({currentAction:e,defaultLanguage:t})=>i.default.createElement(r.default,{mode:e?.lang??t,theme:"monokai",name:"brace-editor",style:{width:"calc(100% + 3px)"},tabSize:4,readOnly:!0,highlightActiveLine:!1,value:e?.code??"",markers:e?.markers??[]});s.propTypes={action:o,defaultLanguage:e.string};const u=({updateFocusedActionIndex:e,lastActionIndex:n,focusedActionIndex:a})=>{const[r,l]=t.useState(a+1),[o,c]=t.useState(!1),s=t.useRef(null),u=()=>{r>=1&&r<=n+1?e(r-1):l(a+1)};return t.useEffect((()=>{if(o)return s.current=setInterval((()=>e((e=>e+1))),500),()=>clearInterval(s.current)}),[o,e]),t.useEffect((()=>{s.current&&a>n-1&&(clearInterval(s.current),c(!1),s.current=null)}),[a,n]),t.useEffect((()=>{l(a+1)}),[a]),i.default.createElement("div",{className:"timeline-player"},i.default.createElement("i",{className:"first-button fa fa-fast-backward",onClick:()=>e(0)}),i.default.createElement("i",{className:"previous-button fa fa-step-backward",onClick:()=>e((e=>e>0?e-1:0))}),i.default.createElement("div",{className:"current-snap"},i.default.createElement("input",{type:"number",value:r,onChange:e=>{const t=e.target.value;l(t)},onBlur:u,style:{width:10*`${n}`.length+"px"},onKeyDown:e=>"Enter"===e.key&&u()}),"/",n+1),o?i.default.createElement("i",{className:"pause-button fa fa-solid fa-pause",onClick:()=>{c(!1),clearInterval(s.current),s.current=null}}):i.default.createElement("i",{className:"play-button fa fa-solid fa-play",onClick:()=>{a<n&&c(!0)}}),i.default.createElement("i",{className:"next-button fa fa-step-forward",onClick:()=>e((e=>e<n?e+1:n))}),i.default.createElement("i",{className:"last-button fa fa-fast-forward",onClick:()=>e(n)}))};u.propTypes={updateFocusedActionIndex:e.func.isRequired,lastActionIndex:e.number.isRequired,focusedActionIndex:e.number.isRequired};const d=i.default.memo(c),p=({timelineArray:e,duration:n,language:a="javascript"})=>{const[r,l]=t.useState(0);return i.default.createElement("div",{className:"timeline-wrapper"},i.default.createElement(s,{defaultLanguage:a,currentAction:e[r]}),i.default.createElement(d,{focusedActionIndex:r,duration:n,timelineArray:e,setFocusedActionIndex:l}),i.default.createElement(u,{lastActionIndex:e?.length-1??0,focusedActionIndex:r,updateFocusedActionIndex:l}))};p.propTypes={timelineArray:e.arrayOf(o).isRequired,duration:e.number.isRequired,language:e.string},module.exports=p;
